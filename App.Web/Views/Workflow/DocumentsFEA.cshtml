@model App.Model.Core.Workflow
@{
    Layout = null;
}

<div class="card">
    <div class="card-content">
        <span class="card-title">Documentos</span>
        @foreach (var item in Model.Proceso.Documentos.Where(q => q.Activo))
        {
            <div class="section">
                <p></p>
            </div>

            <h6>
                <i class="material-icons ">attach_file</i>
                <a href="@Url.Action("Download", "Documento", new { id = item.DocumentoId })">@item.FileName</a>
            </h6>
            <small class="grey-text ultra-small">Creado por @item.Email el @item.Fecha</small>
            if (@item.RequiereFirmaElectronica)
            {
                <small><span class="new badge red secondary-content" data-badge-caption="">Oficial</span></small>
            }
            <div class="section">
                Junto con saludar, les escribo para solicitar por favor el requerimiento
            </div>
            if (!string.IsNullOrWhiteSpace(item.Type) && item.Type.Contains("pdf") && item.File != null)
            {
                <embed src="@Url.Action("Show", "Documento", new { id = item.DocumentoId })" type="application/pdf" width="100%" height="200px"></embed>
            }
            if (@item.RequiereFirmaElectronica && item.AutorizadoParaFirma)
            {
                <a class="waves-effect waves-light btn modal-trigger btn blue" href="#@string.Concat("modalFirmaDocumeto",@item.DocumentoId)">Firmar documento</a>
                <div id="@string.Concat("modalFirmaDocumeto",@item.DocumentoId)" class="modal">
                    <div class="modal-content">
                        <h4>Confirmación</h4>
                        <p>¿ Confirma la operación de firma electrónica del documento?</p>
                    </div>
                    <div class="modal-footer m1">
                        @using (Html.BeginForm("Sign", "Documento", FormMethod.Post, new { id = item.DocumentoId }))
                        {
                            @Html.AntiForgeryToken()
                            <button class="waves-effect waves-light btn blue" type="submit">Confirmar</button>
                            <a href="#!" class="modal-close waves-effect btn grey">Cancelar</a>
                        }
                    </div>
                </div>
            }
        }
    </div>
</div>

<div id="modalCreate" class="modal">
    <div class="modal-content">
        <h4>Adjuntar documento</h4>
        @Html.Action("Create", "Documento", new { Model.ProcesoId, Model.WorkflowId })
    </div>
</div>
<div id="modalUpload" class="modal">
    <div class="modal-content" style="background-color:white">
        <h4>Adjuntar documento</h4>
        @Html.Action("Upload", "Documento", new { Model.ProcesoId, Model.WorkflowId })
    </div>
</div>